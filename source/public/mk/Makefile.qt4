# Included by Makefile of QT project.
# x3py framework: https://github.com/rhcad/x3py

ifdef APPTYPE
TARGET   =$(INSTALL_DIR)/$(PROJNAME)$(APPEXT)
else
TARGET   =$(PLUGINS_DIR)/$(PROJNAME).pln
endif
SOURCES  =$(wildcard *.cpp)
OBJS     =$(SOURCES:.cpp=$(OBJEXT))

ifndef QT4_INCLUDE
ifdef QTDIR
QT4_INCLUDE =$(QTDIR)/include
QT4_LIB     =$(QTDIR)/lib
endif
endif

ifdef QT4_INCLUDE

INCLUDES += -I"$(QT4_INCLUDE)" \
            -I"$(QT4_INCLUDE)/QtCore" \
            -I"$(QT4_INCLUDE)/QtGui"

ifdef IS_WIN
QTLIB_EXT =4$(LIBEND)
else
QTLIB_EXT =$(LIBEND)
endif

LIBS     += $(LIBPATHFLAG)"$(QT4_LIB)" \
            $(LIBFLAG)QtCore$(QTLIB_EXT) \
            $(LIBFLAG)QtGui$(QTLIB_EXT)

all:       $(TARGET)
$(TARGET): $(OBJS)
	$(LINK) $(LDFLAGS) $(OUTFLAG)$@ $(OBJS) $(LIBS)

%.d: %.cpp
	$(DEPEND_CC) $@ $(INCLUDES) $<
%$(OBJEXT): %.cpp
	$(CPP) $(CPPFLAGS) $(INCLUDES) -c $<

ifndef clean
include $(SOURCES:.cpp=.d)
endif

endif #QT4_INCLUDE

clean:
ifndef SWIG_TYPE
	rm -rf *.d *.o *.obj *_wrap.*  ._*
ifdef cleanall
	rm -rf $(TARGET)
endif
ifdef touch
	touch -c *
endif
endif
